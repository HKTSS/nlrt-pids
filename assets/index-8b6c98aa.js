var lt=Object.defineProperty;var st=(e,t,n)=>t in e?lt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var U=(e,t,n)=>(st(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&l(r)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function l(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function O(){}const Ge=e=>e;function Ve(e){return e()}function Le(){return Object.create(null)}function J(e){e.forEach(Ve)}function Pe(e){return typeof e=="function"}function ce(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let _e;function it(e,t){return _e||(_e=document.createElement("a")),_e.href=t,e===_e.href}function rt(e){return Object.keys(e).length===0}const Qe=typeof window<"u";let ot=Qe?()=>window.performance.now():()=>Date.now(),Ce=Qe?e=>requestAnimationFrame(e):O;const ee=new Set;function Je(e){ee.forEach(t=>{t.c(e)||(ee.delete(t),t.f())}),ee.size!==0&&Ce(Je)}function at(e){let t;return ee.size===0&&Ce(Je),{promise:new Promise(n=>{ee.add(t={c:e,f:n})}),abort(){ee.delete(t)}}}function a(e,t){e.appendChild(t)}function Xe(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function ut(e){const t=m("style");return ct(Xe(e),t),t.sheet}function ct(e,t){return a(e.head||e,t),t.sheet}function A(e,t,n){e.insertBefore(t,n||null)}function R(e){e.parentNode&&e.parentNode.removeChild(e)}function ve(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function m(e){return document.createElement(e)}function D(e){return document.createTextNode(e)}function C(){return D(" ")}function ft(){return D("")}function ie(e,t,n,l){return e.addEventListener(t,n,l),()=>e.removeEventListener(t,n,l)}function h(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function dt(e){return Array.from(e.childNodes)}function q(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function he(e,t){for(let n=0;n<e.options.length;n+=1){const l=e.options[n];if(l.__value===t){l.selected=!0;return}}e.selectedIndex=-1}function Ee(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}function xe(e,t,{bubbles:n=!1,cancelable:l=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(e,n,l,t),s}const we=new Map;let ye=0;function _t(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}function ht(e,t){const n={stylesheet:ut(t),rules:{}};return we.set(e,n),n}function Me(e,t,n,l,s,i,r,o=0){const c=16.666/l;let u=`{
`;for(let k=0;k<=1;k+=c){const I=t+(n-t)*i(k);u+=k*100+`%{${r(I,1-I)}}
`}const _=u+`100% {${r(n,1-n)}}
}`,g=`__svelte_${_t(_)}_${o}`,p=Xe(e),{stylesheet:d,rules:v}=we.get(p)||ht(p,e);v[g]||(v[g]=!0,d.insertRule(`@keyframes ${g} ${_}`,d.cssRules.length));const b=e.style.animation||"";return e.style.animation=`${b?`${b}, `:""}${g} ${l}ms linear ${s}ms 1 both`,ye+=1,g}function mt(e,t){const n=(e.style.animation||"").split(", "),l=n.filter(t?i=>i.indexOf(t)<0:i=>i.indexOf("__svelte")===-1),s=n.length-l.length;s&&(e.style.animation=l.join(", "),ye-=s,ye||gt())}function gt(){Ce(()=>{ye||(we.forEach(e=>{const{ownerNode:t}=e.stylesheet;t&&R(t)}),we.clear())})}let oe;function re(e){oe=e}function et(){if(!oe)throw new Error("Function called outside component initialization");return oe}function $e(e){et().$$.on_mount.push(e)}function pt(){const e=et();return(t,n,{cancelable:l=!1}={})=>{const s=e.$$.callbacks[t];if(s){const i=xe(t,n,{cancelable:l});return s.slice().forEach(r=>{r.call(e,i)}),!i.defaultPrevented}return!0}}function tt(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach(l=>l.call(this,t))}const se=[],be=[],ge=[],Te=[],vt=Promise.resolve();let Ie=!1;function wt(){Ie||(Ie=!0,vt.then(nt))}function X(e){ge.push(e)}function ze(e){Te.push(e)}const je=new Set;let me=0;function nt(){const e=oe;do{for(;me<se.length;){const t=se[me];me++,re(t),yt(t.$$)}for(re(null),se.length=0,me=0;be.length;)be.pop()();for(let t=0;t<ge.length;t+=1){const n=ge[t];je.has(n)||(je.add(n),n())}ge.length=0}while(se.length);for(;Te.length;)Te.pop()();Ie=!1,je.clear(),re(e)}function yt(e){if(e.fragment!==null){e.update(),J(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(X)}}let le;function bt(){return le||(le=Promise.resolve(),le.then(()=>{le=null})),le}function Se(e,t,n){e.dispatchEvent(xe(`${t?"intro":"outro"}${n}`))}const pe=new Set;let V;function kt(){V={r:0,c:[],p:V}}function jt(){V.r||J(V.c),V=V.p}function Q(e,t){e&&e.i&&(pe.delete(e),e.i(t))}function te(e,t,n,l){if(e&&e.o){if(pe.has(e))return;pe.add(e),V.c.push(()=>{pe.delete(e),l&&(n&&e.d(1),l())}),e.o(t)}else l&&l()}const St={duration:0};function Ne(e,t,n,l){const s={direction:"both"};let i=t(e,n,s),r=l?0:1,o=null,c=null,u=null;function _(){u&&mt(e,u)}function g(d,v){const b=d.b-r;return v*=Math.abs(b),{a:r,b:d.b,d:b,duration:v,start:d.start,end:d.start+v,group:d.group}}function p(d){const{delay:v=0,duration:b=300,easing:k=Ge,tick:I=O,css:L}=i||St,P={start:ot()+v,b:d};d||(P.group=V,V.r+=1),o||c?c=P:(L&&(_(),u=Me(e,r,d,b,v,k,L)),d&&I(0,1),o=g(P,b),X(()=>Se(e,d,"start")),at($=>{if(c&&$>c.start&&(o=g(c,b),c=null,Se(e,o.b,"start"),L&&(_(),u=Me(e,r,o.b,o.duration,0,k,i.css))),o){if($>=o.end)I(r=o.b,1-r),Se(e,o.b,"end"),c||(o.b?_():--o.group.r||J(o.group.c)),o=null;else if($>=o.start){const H=$-o.start;r=o.a+o.d*k(H/o.duration),I(r,1-r)}}return!!(o||c)}))}return{run(d){Pe(i)?bt().then(()=>{i=i(s),p(d)}):p(d)},end(){_(),o=c=null}}}function De(e,t,n,l){const s=e.$$.props[t];s!==void 0&&(e.$$.bound[s]=n,l===void 0&&n(e.$$.ctx[s]))}function ke(e){e&&e.c()}function ae(e,t,n,l){const{fragment:s,after_update:i}=e.$$;s&&s.m(t,n),l||X(()=>{const r=e.$$.on_mount.map(Ve).filter(Pe);e.$$.on_destroy?e.$$.on_destroy.push(...r):J(r),e.$$.on_mount=[]}),i.forEach(X)}function ue(e,t){const n=e.$$;n.fragment!==null&&(J(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Tt(e,t){e.$$.dirty[0]===-1&&(se.push(e),wt(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function fe(e,t,n,l,s,i,r,o=[-1]){const c=oe;re(e);const u=e.$$={fragment:null,ctx:[],props:i,update:O,not_equal:s,bound:Le(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(c?c.$$.context:[])),callbacks:Le(),dirty:o,skip_bound:!1,root:t.target||c.$$.root};r&&r(u.root);let _=!1;if(u.ctx=n?n(e,t.props||{},(g,p,...d)=>{const v=d.length?d[0]:p;return u.ctx&&s(u.ctx[g],u.ctx[g]=v)&&(!u.skip_bound&&u.bound[g]&&u.bound[g](v),_&&Tt(e,g)),p}):[],u.update(),_=!0,J(u.before_update),u.fragment=l?l(u.ctx):!1,t.target){if(t.hydrate){const g=dt(t.target);u.fragment&&u.fragment.l(g),g.forEach(R)}else u.fragment&&u.fragment.c();t.intro&&Q(e.$$.fragment),ae(e,t.target,t.anchor,t.customElement),nt()}re(c)}class de{$destroy(){ue(this,1),this.$destroy=O}$on(t,n){if(!Pe(n))return O;const l=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return l.push(n),()=>{const s=l.indexOf(n);s!==-1&&l.splice(s,1)}}$set(t){this.$$set&&!rt(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function Re(e,{delay:t=0,duration:n=400,easing:l=Ge}={}){const s=+getComputedStyle(e).opacity;return{delay:t,duration:n,easing:l,css:i=>`opacity: ${i*s}`}}const It="https://rt.data.gov.hk/v1/transport/mtr/lrt/getSchedule?station_id={stn}",Pt="https://rt.data.gov.hk/v1/transport/mtr/lrt/getSchedule?station_id={stn}";class Ct{constructor(t,n,l,s,i,r){U(this,"route_no");U(this,"train_length");U(this,"dest_zh");U(this,"dest_en");U(this,"time_num");U(this,"time_text");this.route_no=t,this.train_length=n,this.dest_zh=l,this.dest_en=s,this.time_text=r,this.time_num=i}}class f{constructor(t,n,l){U(this,"name");U(this,"initials");U(this,"platforms");this.name=n,this.initials=t,this.platforms=l}}function $t(e,t=!1){return(t?Pt:It).replace("{stn}",e)}const x=new Map([["1",new f("1","屯門碼頭|Tuen Mun Ferry Pier",[2,3,4,5,7])],["10",new f("10","美樂|Melody Garden",[1,2])],["15",new f("15","蝴蝶|Butterfly",[1,2])],["20",new f("20","輕鐵車廠|Light Rail Depot",[1,2])],["30",new f("30","龍門|Lung Mun",[1,2])],["40",new f("40","青山村|Tsing Shan Tsuen",[1,2])],["50",new f("50","青雲|Tsing Wun",[1,2])],["60",new f("60","建安|Kin On",[1,2])],["70",new f("70","河田|Ho Tin",[1,2])],["75",new f("75","蔡意橋|Choy Yee Bridge",[1,2])],["80",new f("80","澤豐|Affluence",[1,2])],["90",new f("90","屯門醫院|Tuen Mun Hospital",[1,2])],["100",new f("100","兆康|Siu Hong",[1,2,5,6])],["110",new f("110","麒麟|Kei Lun",[1,2])],["120",new f("120","青松|Ching Chung",[1,2])],["130",new f("130","建生|Kin Sang",[1,2])],["140",new f("140","田景|Tin King",[1,2,3])],["150",new f("150","良景|Leung King",[1,2])],["160",new f("160","新圍|San Wai",[1,2])],["170",new f("170","石排|Shek Pai",[1,2])],["180",new f("180","山景 (北)|Shan King (North)",[1])],["190",new f("190","山景 (南)|Shan King (South)",[1])],["200",new f("200","鳴琴|Ming Kum",[1,2])],["212",new f("212","大興 (北)|Tai Hing (North)",[1,2])],["220",new f("220","大興 (南)|Tai Hing (South)",[1,2])],["230",new f("230","銀圍|Ngan Wai",[1,2])],["240",new f("240","兆禧|Siu Hei",[1,2])],["250",new f("250","屯門泳池|Tuen Mun Swimming Pool",[1,2])],["260",new f("260","豐景園|Goodview Garden",[1,2])],["265",new f("265","兆麟|Siu Lun",[1,2])],["270",new f("270","安定|On Ting",[1,2])],["275",new f("275","友愛|Yau Oi",[1])],["280",new f("280","市中心|Town Centre",[4])],["295",new f("295","屯門|Tuen Mun",[1,2])],["300",new f("300","杯渡|Pui To",[1,2])],["310",new f("310","何福堂|Hoh Fuk Tong",[1,2])],["320",new f("320","新墟|San Hui",[1,2])],["330",new f("330","景峰|Prime View",[1,2])],["340",new f("340","鳳地|Fung Tei",[1,2])],["350",new f("350","藍地|Lam Tei",[1,2])],["360",new f("360","泥圍|Nai Wai",[1,2])],["370",new f("370","鍾屋村|Chung Uk Tsuen",[1,2])],["380",new f("380","洪水橋|Hung Shui Kiu",[1,2])],["390",new f("390","塘坊村|Tong Fong Tsuen",[1,2])],["400",new f("400","屏山|Ping Shan",[1,2])],["425",new f("425","坑尾村|Hang Mei Tsuen",[1,2])],["430",new f("430","天水圍|Tin Shui Wai",[1,2,3])],["435",new f("435","天慈|Tin Tsz",[1,2])],["445",new f("445","天耀|Tin Yiu",[1,2])],["448",new f("448","樂湖|Locwood",[1,2])],["450",new f("450","天湖|Tin Wu",[1,2])],["455",new f("455","銀座|Ginza",[1,2])],["460",new f("460","天瑞|Tin Shui",[1,2])],["468",new f("468","頌富|Chung Fu",[1,2])],["480",new f("480","天富|Tin Fu",[1,2])],["490",new f("490","翠湖|Chestwood",[1,2])],["500",new f("500","天榮|Tin Wing",[6,7])],["510",new f("510","天悅|Tin Yuet",[1,2])],["520",new f("520","天秀|Tin Sau",[1,2])],["530",new f("530","濕地公園|Wetland Park",[1,2])],["540",new f("540","天恒|Tin Heng",[1,2])],["550",new f("550","天逸|Tin Yat",[1,2,4,5])],["560",new f("560","水邊圍|Shui Pin Wai",[1,2])],["570",new f("570","豐年路|Fung Nin Road",[1,2])],["580",new f("580","康樂路|Hong Lok Road",[1,2])],["590",new f("590","大棠路|Tai Tong Road",[1,2])],["600",new f("600","元朗|Yuen Long",[2,3,4,5])],["920",new f("920","三聖|Sam Shing",[1,3])]]);function Ht(e){let t,n,l,s,i,r,o,c,u,_,g,p=(e[3]||"站名")+"",d,v,b,k,I=(e[4]||"Station Name")+"",L,P,$,H,W,F,G,K;return{c(){t=m("div"),n=m("table"),l=m("tr"),s=m("td"),i=m("span"),r=D(e[0]),o=C(),c=m("div"),c.innerHTML="月台<br/>Platform",u=C(),_=m("td"),g=m("span"),d=D(p),v=m("br"),b=C(),k=m("span"),L=D(I),P=C(),$=m("td"),H=D(e[1]),W=D(":"),F=D(e[2]),h(i,"class","platcircle svelte-qg4tih"),h(c,"class","plattext svelte-qg4tih"),h(s,"class","platformCell svelte-qg4tih"),h(g,"class","sizeZH svelte-qg4tih"),h(k,"class","en"),h(_,"class","stnName svelte-qg4tih"),h(_,"role","button"),h(_,"tabindex","0"),h(_,"title","Show Config Menu"),h($,"class","clock svelte-qg4tih"),h(n,"id","titlebarTB"),h(n,"class","svelte-qg4tih"),h(t,"id","titlebar"),h(t,"class","svelte-qg4tih")},m(E,N){A(E,t,N),a(t,n),a(n,l),a(l,s),a(s,i),a(i,r),a(s,o),a(s,c),a(l,u),a(l,_),a(_,g),a(g,d),a(_,v),a(_,b),a(_,k),a(k,L),a(l,P),a(l,$),a($,H),a($,W),a($,F),G||(K=[ie(_,"click",e[5]),ie(_,"keypress",e[5])],G=!0)},p(E,[N]){N&1&&q(r,E[0]),N&8&&p!==(p=(E[3]||"站名")+"")&&q(d,p),N&16&&I!==(I=(E[4]||"Station Name")+"")&&q(L,I),N&2&&q(H,E[1]),N&4&&q(F,E[2])},i:O,o:O,d(E){E&&R(t),G=!1,J(K)}}}function Lt(e,t,n){let{stnId:l}=t,{platform:s}=t;const i=pt();let r=new Date,o,c,u,_;function g(){i("showConfig")}function p(){n(8,r=new Date)}return $e(()=>{const d=setInterval(p,2e3);return p(),()=>clearInterval(d)}),e.$$set=d=>{"stnId"in d&&n(6,l=d.stnId),"platform"in d&&n(0,s=d.platform)},e.$$.update=()=>{var d,v;e.$$.dirty&256&&n(1,o=r.getHours().toString().padStart(2,"0")),e.$$.dirty&256&&n(2,c=r.getMinutes().toString().padStart(2,"0")),e.$$.dirty&64&&n(3,u=((d=x.get(l))==null?void 0:d.name.split("|")[0])||""),e.$$.dirty&64&&n(4,_=((v=x.get(l))==null?void 0:v.name.split("|")[1])||"")},[s,o,c,u,_,g,l,p,r]}class Et extends de{constructor(t){super(),fe(this,t,Lt,Ht,ce,{stnId:6,platform:0,updateDate:7})}get updateDate(){return this.$$.ctx[7]}}function Ae(e,t,n){const l=e.slice();return l[4]=t[n],l[6]=n,l}function Oe(e,t,n){const l=e.slice();return l[4]=t[n],l[6]=n,l}function Mt(e){let t;return{c(){t=m("tr"),t.innerHTML=`<td class="lineHeightDouble sizeDouble svelte-19ujjsy"> </td> 
            <td class="svelte-19ujjsy"></td> 
            <td class="svelte-19ujjsy"></td> 
            <td class="svelte-19ujjsy"></td> 
          `,h(t,"class","arrRow svelte-19ujjsy")},m(n,l){A(n,t,l)},p:O,d(n){n&&R(t)}}}function zt(e){let t,n,l=e[0][e[6]].route_no+"",s,i,r,o,c=e[0][e[6]].dest_zh+"",u,_,g=e[0][e[6]].dest_en+"",p,d,v,b,k,I,L,P=e[0][e[6]].time_num+"",$,H,W=e[0][e[6]].time_text.split("|")[0]+"",F,G,K=e[0][e[6]].time_text.split("|")[1]+"",E,N,Z={length:e[0][e[6]].train_length},M=[];for(let w=0;w<Z.length;w+=1)M[w]=qe(Oe(e,Z,w));return{c(){t=m("tr"),n=m("td"),s=D(l),i=C(),r=m("td"),o=m("span"),u=D(c),_=m("br"),p=D(g),d=C(),v=m("td"),b=m("div");for(let w=0;w<M.length;w+=1)M[w].c();k=C(),I=m("td"),L=m("span"),$=D(P),H=m("span"),F=D(W),G=m("br"),E=D(K),N=C(),h(n,"class","lineHeightDouble sizeDouble svelte-19ujjsy"),h(o,"class","sizeZH svelte-19ujjsy"),h(r,"class","svelte-19ujjsy"),h(b,"class","cars svelte-19ujjsy"),h(v,"class","svelte-19ujjsy"),h(L,"class","sizeDouble multiLine svelte-19ujjsy"),h(H,"class","eta"),h(I,"class","svelte-19ujjsy"),h(t,"class","arrRow svelte-19ujjsy")},m(w,j){A(w,t,j),a(t,n),a(n,s),a(t,i),a(t,r),a(r,o),a(o,u),a(r,_),a(r,p),a(t,d),a(t,v),a(v,b);for(let T=0;T<M.length;T+=1)M[T].m(b,null);a(t,k),a(t,I),a(I,L),a(L,$),a(I,H),a(H,F),a(H,G),a(H,E),a(t,N)},p(w,j){if(j&1&&l!==(l=w[0][w[6]].route_no+"")&&q(s,l),j&1&&c!==(c=w[0][w[6]].dest_zh+"")&&q(u,c),j&1&&g!==(g=w[0][w[6]].dest_en+"")&&q(p,g),j&1){Z={length:w[0][w[6]].train_length};let T;for(T=0;T<Z.length;T+=1){const z=Oe(w,Z,T);M[T]?M[T].p(z,j):(M[T]=qe(z),M[T].c(),M[T].m(b,null))}for(;T<M.length;T+=1)M[T].d(1);M.length=Z.length}j&1&&P!==(P=w[0][w[6]].time_num+"")&&q($,P),j&1&&W!==(W=w[0][w[6]].time_text.split("|")[0]+"")&&q(F,W),j&1&&K!==(K=w[0][w[6]].time_text.split("|")[1]+"")&&q(E,K)},d(w){w&&R(t),ve(M,w)}}}function qe(e){let t,n;return{c(){t=m("img"),h(t,"class","car svelte-19ujjsy"),it(t.src,n="img/lrv.png")||h(t,"src",n),h(t,"alt","LRV Car "+e[6])},m(l,s){A(l,t,s)},p:O,d(l){l&&R(t)}}}function Fe(e){let t;function n(i,r){return i[6]<i[0].length?zt:Mt}let l=n(e),s=l(e);return{c(){s.c(),t=ft()},m(i,r){s.m(i,r),A(i,t,r)},p(i,r){l===(l=n(i))&&s?s.p(i,r):(s.d(1),s=l(i),s&&(s.c(),s.m(t.parentNode,t)))},d(i){s.d(i),i&&R(t)}}}function Nt(e){let t,n,l,s,i={length:Ke},r=[];for(let o=0;o<i.length;o+=1)r[o]=Fe(Ae(e,i,o));return{c(){t=m("main"),n=m("table"),l=m("tr"),l.innerHTML=`<td class="svelte-19ujjsy"><span class="sizeZH svelte-19ujjsy">路線</span><br/>Route</td> 
          <td class="svelte-19ujjsy"><span class="sizeZH svelte-19ujjsy">目的地</span><br/>Destination</td> 
          <td class="svelte-19ujjsy"></td> 
          <td class="svelte-19ujjsy"><span class="sizeZH svelte-19ujjsy">下班車</span><br/>Next Train</td>`,s=C();for(let o=0;o<r.length;o+=1)r[o].c();h(l,"class","header svelte-19ujjsy"),h(n,"id","eta"),h(n,"class","svelte-19ujjsy"),h(t,"class","svelte-19ujjsy")},m(o,c){A(o,t,c),a(t,n),a(n,l),a(n,s);for(let u=0;u<r.length;u+=1)r[u].m(n,null)},p(o,[c]){if(c&1){i={length:Ke};let u;for(u=0;u<i.length;u+=1){const _=Ae(o,i,u);r[u]?r[u].p(_,c):(r[u]=Fe(_),r[u].c(),r[u].m(n,null))}for(;u<r.length;u+=1)r[u].d(1);r.length=i.length}},i:O,o:O,d(o){o&&R(t),ve(r,o)}}}const Ke=10;function Dt(e,t,n){let{stnId:l}=t,{targetPlatform:s}=t,i=[];async function r(o,c,u=!1){if(o==null||c==null)return;let _;try{_=await fetch($t(o,u))}catch{if(!u)return console.warn("Cannot fetch data from proxy server, falling back to MTR"),r(o,c,!0)}let g=await _.json();if(g.status!=1)return;let p=[];for(let d of g.platform_list)if(d.platform_id===c)for(let v of d.route_list){if(v.stop===1)continue;let b,k;v.time_en.includes("min")?(b="分鐘|min",k=v.time_en.split(" min")[0]):v.time_en==="-"?(b=" | ",k="-"):(k="",b=`${v.time_ch}|${v.time_en}`);let I=new Ct(v.route_no,v.train_length,v.dest_ch,v.dest_en,k,b);p.push(I)}n(0,i=p)}return $e(async()=>{const o=setInterval(async()=>await r(l,s),1e4);return()=>clearInterval(o)}),e.$$set=o=>{"stnId"in o&&n(1,l=o.stnId),"targetPlatform"in o&&n(2,s=o.targetPlatform)},e.$$.update=()=>{e.$$.dirty&6&&r(l,s)},[i,l,s]}class Rt extends de{constructor(t){super(),fe(this,t,Dt,Nt,ce,{stnId:1,targetPlatform:2})}}function At(e){let t,n,l,s;return t=new Et({props:{stnId:e[0],platform:e[1]}}),t.$on("showConfig",e[2]),l=new Rt({props:{stnId:e[0],targetPlatform:e[1]}}),{c(){ke(t.$$.fragment),n=C(),ke(l.$$.fragment)},m(i,r){ae(t,i,r),A(i,n,r),ae(l,i,r),s=!0},p(i,[r]){const o={};r&1&&(o.stnId=i[0]),r&2&&(o.platform=i[1]),t.$set(o);const c={};r&1&&(c.stnId=i[0]),r&2&&(c.targetPlatform=i[1]),l.$set(c)},i(i){s||(Q(t.$$.fragment,i),Q(l.$$.fragment,i),s=!0)},o(i){te(t.$$.fragment,i),te(l.$$.fragment,i),s=!1},d(i){ue(t,i),i&&R(n),ue(l,i)}}}function Ot(e,t,n){let{stnId:l}=t,{platform:s}=t;function i(r){tt.call(this,e,r)}return e.$$set=r=>{"stnId"in r&&n(0,l=r.stnId),"platform"in r&&n(1,s=r.platform)},[l,s,i]}class qt extends de{constructor(t){super(),fe(this,t,Ot,At,ce,{stnId:0,platform:1})}}function We(e,t,n){const l=e.slice();return l[5]=t[n],l}function Ze(e,t,n){const l=e.slice();return l[8]=t[n][0],l[9]=t[n][1],l}function Be(e){let t,n=e[9].name.replace("|"," ")+"",l;return{c(){t=m("option"),l=D(n),t.__value=e[8],t.value=t.__value},m(s,i){A(s,t,i),a(t,l)},p:O,d(s){s&&R(t)}}}function Ye(e){let t,n=e[5]+"",l,s;return{c(){t=m("option"),l=D(n),t.__value=s=e[5],t.value=t.__value},m(i,r){A(i,t,r),a(t,l)},p(i,r){r&1&&n!==(n=i[5]+"")&&q(l,n),r&1&&s!==(s=i[5])&&(t.__value=s,t.value=t.__value)},d(i){i&&R(t)}}}function Ft(e){var He;let t,n,l,s,i,r,o,c,u,_,g,p,d,v,b,k,I,L,P,$,H,W,F,G,K,E,N,Z,M,w=[...x],j=[];for(let y=0;y<w.length;y+=1)j[y]=Be(Ze(e,w,y));let T=((He=x.get(e[0]))==null?void 0:He.platforms)??[],z=[];for(let y=0;y<T.length;y+=1)z[y]=Ye(We(e,T,y));return{c(){t=m("main"),n=m("h1"),n.textContent="輕鐵資訊顯示屏模擬器",l=C(),s=m("h3"),s.textContent="Light Rail PIDS Simulator",i=C(),r=m("hr"),o=C(),c=m("table"),u=m("tr"),_=m("td"),_.innerHTML='<span class="sizeZH svelte-v2nkaw">車站</span><br/><span class="sizeEN svelte-v2nkaw">Station</span>',g=C(),p=m("td"),d=m("select");for(let y=0;y<j.length;y+=1)j[y].c();v=C(),b=m("tr"),k=m("td"),k.innerHTML='<span class="sizeZH svelte-v2nkaw">月台</span><br/><span class="sizeEN svelte-v2nkaw">Platform</span>',I=C(),L=m("td"),P=m("select");for(let y=0;y<z.length;y+=1)z[y].c();$=C(),H=m("button"),H.textContent="開始 Start",W=C(),F=m("p"),F.textContent="如需要再顯示此菜單，請按頂部的車站名",G=C(),K=m("p"),K.textContent="Click the station name at the top to return to this menu.",E=C(),N=m("footer"),N.innerHTML=`<p class="svelte-v2nkaw">HKTSS 2023</p> 
    <p class="svelte-v2nkaw"><a href="https://hktss.github.io/mtr-pids/" class="svelte-v2nkaw">願景資訊顯示屏模擬器</a></p>`,h(n,"class","sizeZH svelte-v2nkaw"),h(s,"class","sizeEN svelte-v2nkaw"),h(_,"class","svelte-v2nkaw"),h(d,"id","stnOpt"),h(d,"class","svelte-v2nkaw"),e[0]===void 0&&X(()=>e[3].call(d)),h(p,"class","svelte-v2nkaw"),h(u,"class","svelte-v2nkaw"),h(k,"class","svelte-v2nkaw"),h(P,"id","platOpt"),h(P,"class","svelte-v2nkaw"),e[1]===void 0&&X(()=>e[4].call(P)),h(L,"class","svelte-v2nkaw"),h(b,"class","svelte-v2nkaw"),h(c,"id","cfgTable"),h(c,"class","svelte-v2nkaw"),h(H,"class","closeBtn svelte-v2nkaw"),h(t,"class","svelte-v2nkaw"),h(N,"class","svelte-v2nkaw")},m(y,B){A(y,t,B),a(t,n),a(t,l),a(t,s),a(t,i),a(t,r),a(t,o),a(t,c),a(c,u),a(u,_),a(u,g),a(u,p),a(p,d);for(let Y=0;Y<j.length;Y+=1)j[Y].m(d,null);he(d,e[0]),a(c,v),a(c,b),a(b,k),a(b,I),a(b,L),a(L,P);for(let Y=0;Y<z.length;Y+=1)z[Y].m(P,null);he(P,e[1]),a(t,$),a(t,H),a(t,W),a(t,F),a(t,G),a(t,K),A(y,E,B),A(y,N,B),Z||(M=[ie(d,"change",e[3]),ie(P,"change",e[4]),ie(H,"click",e[2])],Z=!0)},p(y,[B]){var Y;if(B&0){w=[...x];let S;for(S=0;S<w.length;S+=1){const ne=Ze(y,w,S);j[S]?j[S].p(ne,B):(j[S]=Be(ne),j[S].c(),j[S].m(d,null))}for(;S<j.length;S+=1)j[S].d(1);j.length=w.length}if(B&1&&he(d,y[0]),B&1){T=((Y=x.get(y[0]))==null?void 0:Y.platforms)??[];let S;for(S=0;S<T.length;S+=1){const ne=We(y,T,S);z[S]?z[S].p(ne,B):(z[S]=Ye(ne),z[S].c(),z[S].m(P,null))}for(;S<z.length;S+=1)z[S].d(1);z.length=T.length}B&3&&he(P,y[1])},i:O,o:O,d(y){y&&R(t),ve(j,y),ve(z,y),y&&R(E),y&&R(N),Z=!1,J(M)}}}function Kt(e,t,n){let{stationId:l}=t,{selectedPlatform:s}=t;function i(c){tt.call(this,e,c)}function r(){l=Ee(this),n(0,l)}function o(){s=Ee(this),n(1,s),n(0,l)}return e.$$set=c=>{"stationId"in c&&n(0,l=c.stationId),"selectedPlatform"in c&&n(1,s=c.selectedPlatform)},[l,s,i,r,o]}class Wt extends de{constructor(t){super(),fe(this,t,Kt,Ft,ce,{stationId:0,selectedPlatform:1})}}function Ue(e){let t,n,l,s,i,r;function o(_){e[4](_)}function c(_){e[5](_)}let u={};return e[0]!==void 0&&(u.stationId=e[0]),e[1]!==void 0&&(u.selectedPlatform=e[1]),n=new Wt({props:u}),be.push(()=>De(n,"stationId",o,e[0])),be.push(()=>De(n,"selectedPlatform",c,e[1])),n.$on("click",e[6]),{c(){t=m("div"),ke(n.$$.fragment),h(t,"class","portrait svelte-vsivdu")},m(_,g){A(_,t,g),ae(n,t,null),r=!0},p(_,g){const p={};!l&&g&1&&(l=!0,p.stationId=_[0],ze(()=>l=!1)),!s&&g&2&&(s=!0,p.selectedPlatform=_[1],ze(()=>s=!1)),n.$set(p)},i(_){r||(Q(n.$$.fragment,_),X(()=>{i||(i=Ne(t,Re,{duration:100},!0)),i.run(1)}),r=!0)},o(_){te(n.$$.fragment,_),i||(i=Ne(t,Re,{duration:100},!1)),i.run(0),r=!1},d(_){_&&R(t),ue(n),_&&i&&i.end()}}}function Zt(e){let t,n,l,s,i;l=new qt({props:{stnId:e[0],platform:e[1]}}),l.$on("showConfig",e[3]);let r=e[2]&&Ue(e);return{c(){t=m("main"),n=m("div"),ke(l.$$.fragment),s=C(),r&&r.c(),h(n,"class","portrait svelte-vsivdu"),h(t,"class","svelte-vsivdu")},m(o,c){A(o,t,c),a(t,n),ae(l,n,null),a(t,s),r&&r.m(t,null),i=!0},p(o,[c]){const u={};c&1&&(u.stnId=o[0]),c&2&&(u.platform=o[1]),l.$set(u),o[2]?r?(r.p(o,c),c&4&&Q(r,1)):(r=Ue(o),r.c(),Q(r,1),r.m(t,null)):r&&(kt(),te(r,1,1,()=>{r=null}),jt())},i(o){i||(Q(l.$$.fragment,o),Q(r),i=!0)},o(o){te(l.$$.fragment,o),te(r),i=!1},d(o){o&&R(t),ue(l),r&&r.d()}}}function Bt(e,t){e!==void 0&&localStorage.setItem("stnId",e),t!==void 0&&localStorage.setItem("platform",t.toString())}function Yt(e,t,n){let l,s,i=!1;function r(){let p=localStorage.getItem("platform"),d=localStorage.getItem("stnId");p==null||d==null?(n(0,l="1"),n(1,s=2),n(2,i=!0)):(n(0,l=d),n(1,s=parseInt(p)))}function o(){const p=new URLSearchParams(window.location.search),d=Object.fromEntries(p.entries());d.stnId!=null&&d.plat!=null&&(n(2,i=!1),n(0,l=d.stnId),n(1,s=parseInt(d.plat)))}$e(()=>{r(),o()});const c=()=>n(2,i=!0);function u(p){l=p,n(0,l)}function _(p){s=p,n(1,s)}const g=()=>n(2,i=!1);return e.$$.update=()=>{e.$$.dirty&3&&Bt(l,s)},[l,s,i,c,u,_,g]}class Ut extends de{constructor(t){super(),fe(this,t,Yt,Zt,ce,{})}}new Ut({target:document.getElementById("app")});
