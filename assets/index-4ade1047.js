var ft=Object.defineProperty;var dt=(e,t,n)=>t in e?ft(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var G=(e,t,n)=>(dt(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))l(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&l(r)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function F(){}const nt=e=>e;function lt(e){return e()}function je(){return Object.create(null)}function x(e){e.forEach(lt)}function Re(e){return typeof e=="function"}function ge(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let be;function ht(e,t){return be||(be=document.createElement("a")),be.href=t,e===be.href}function _t(e){return Object.keys(e).length===0}function ke(e){return e??""}const st=typeof window<"u";let pt=st?()=>window.performance.now():()=>Date.now(),Oe=st?e=>requestAnimationFrame(e):F;const oe=new Set;function it(e){oe.forEach(t=>{t.c(e)||(oe.delete(t),t.f())}),oe.size!==0&&Oe(it)}function mt(e){let t;return oe.size===0&&Oe(it),{promise:new Promise(n=>{oe.add(t={c:e,f:n})}),abort(){oe.delete(t)}}}function c(e,t){e.appendChild(t)}function rt(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function gt(e){const t=p("style");return vt(rt(e),t),t.sheet}function vt(e,t){return c(e.head||e,t),t.sheet}function j(e,t,n){e.insertBefore(t,n||null)}function R(e){e.parentNode&&e.parentNode.removeChild(e)}function Te(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function p(e){return document.createElement(e)}function D(e){return document.createTextNode(e)}function T(){return D(" ")}function wt(){return D("")}function ee(e,t,n,l){return e.addEventListener(t,n,l),()=>e.removeEventListener(t,n,l)}function _(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function bt(e){return Array.from(e.childNodes)}function W(e,t){t=""+t,e.data!==t&&(e.data=t)}function ye(e,t,n){for(let l=0;l<e.options.length;l+=1){const i=e.options[l];if(i.__value===t){i.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function Fe(e){const t=e.querySelector(":checked");return t&&t.__value}function ot(e,t,{bubbles:n=!1,cancelable:l=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(e,n,l,t),i}const Ie=new Map;let ze=0;function yt(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}function St(e,t){const n={stylesheet:gt(t),rules:{}};return Ie.set(e,n),n}function Ke(e,t,n,l,i,s,r,o=0){const a=16.666/l;let d=`{
`;for(let y=0;y<=1;y+=a){const I=t+(n-t)*s(y);d+=y*100+`%{${r(I,1-I)}}
`}const g=d+`100% {${r(n,1-n)}}
}`,m=`__svelte_${yt(g)}_${o}`,w=rt(e),{stylesheet:u,rules:h}=Ie.get(w)||St(w,e);h[m]||(h[m]=!0,u.insertRule(`@keyframes ${m} ${g}`,u.cssRules.length));const v=e.style.animation||"";return e.style.animation=`${v?`${v}, `:""}${m} ${l}ms linear ${i}ms 1 both`,ze+=1,m}function kt(e,t){const n=(e.style.animation||"").split(", "),l=n.filter(t?s=>s.indexOf(t)<0:s=>s.indexOf("__svelte")===-1),i=n.length-l.length;i&&(e.style.animation=l.join(", "),ze-=i,ze||Tt())}function Tt(){Oe(()=>{ze||(Ie.forEach(e=>{const{ownerNode:t}=e.stylesheet;t&&R(t)}),Ie.clear())})}let _e;function de(e){_e=e}function at(){if(!_e)throw new Error("Function called outside component initialization");return _e}function Ae(e){at().$$.on_mount.push(e)}function It(){const e=at();return(t,n,{cancelable:l=!1}={})=>{const i=e.$$.callbacks[t];if(i){const s=ot(t,n,{cancelable:l});return i.slice().forEach(r=>{r.call(e,s)}),!s.defaultPrevented}return!0}}function ct(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach(l=>l.call(this,t))}const ie=[],he=[];let ae=[];const Ne=[],zt=Promise.resolve();let De=!1;function Ht(){De||(De=!0,zt.then(ut))}function te(e){ae.push(e)}function Ce(e){Ne.push(e)}const Ee=new Set;let se=0;function ut(){if(se!==0)return;const e=_e;do{try{for(;se<ie.length;){const t=ie[se];se++,de(t),Pt(t.$$)}}catch(t){throw ie.length=0,se=0,t}for(de(null),ie.length=0,se=0;he.length;)he.pop()();for(let t=0;t<ae.length;t+=1){const n=ae[t];Ee.has(n)||(Ee.add(n),n())}ae.length=0}while(ie.length);for(;Ne.length;)Ne.pop()();De=!1,Ee.clear(),de(e)}function Pt(e){if(e.fragment!==null){e.update(),x(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(te)}}function Ct(e){const t=[],n=[];ae.forEach(l=>e.indexOf(l)===-1?t.push(l):n.push(l)),n.forEach(l=>l()),ae=t}let fe;function Et(){return fe||(fe=Promise.resolve(),fe.then(()=>{fe=null})),fe}function Le(e,t,n){e.dispatchEvent(ot(`${t?"intro":"outro"}${n}`))}const Se=new Set;let Q;function Lt(){Q={r:0,c:[],p:Q}}function Mt(){Q.r||x(Q.c),Q=Q.p}function X(e,t){e&&e.i&&(Se.delete(e),e.i(t))}function ce(e,t,n,l){if(e&&e.o){if(Se.has(e))return;Se.add(e),Q.c.push(()=>{Se.delete(e),l&&(n&&e.d(1),l())}),e.o(t)}else l&&l()}const Nt={duration:0};function Ze(e,t,n,l){const i={direction:"both"};let s=t(e,n,i),r=l?0:1,o=null,a=null,d=null;function g(){d&&kt(e,d)}function m(u,h){const v=u.b-r;return h*=Math.abs(v),{a:r,b:u.b,d:v,duration:h,start:u.start,end:u.start+h,group:u.group}}function w(u){const{delay:h=0,duration:v=300,easing:y=nt,tick:I=F,css:E}=s||Nt,z={start:pt()+h,b:u};u||(z.group=Q,Q.r+=1),o||a?a=z:(E&&(g(),d=Ke(e,r,u,v,h,y,E)),u&&I(0,1),o=m(z,v),te(()=>Le(e,u,"start")),mt(L=>{if(a&&L>a.start&&(o=m(a,v),a=null,Le(e,o.b,"start"),E&&(g(),d=Ke(e,r,o.b,o.duration,0,y,s.css))),o){if(L>=o.end)I(r=o.b,1-r),Le(e,o.b,"end"),a||(o.b?g():--o.group.r||x(o.group.c)),o=null;else if(L>=o.start){const P=L-o.start;r=o.a+o.d*y(P/o.duration),I(r,1-r)}}return!!(o||a)}))}return{run(u){Re(s)?Et().then(()=>{s=s(i),w(u)}):w(u)},end(){g(),o=a=null}}}function Me(e,t,n){const l=e.$$.props[t];l!==void 0&&(e.$$.bound[l]=n,n(e.$$.ctx[l]))}function He(e){e&&e.c()}function pe(e,t,n,l){const{fragment:i,after_update:s}=e.$$;i&&i.m(t,n),l||te(()=>{const r=e.$$.on_mount.map(lt).filter(Re);e.$$.on_destroy?e.$$.on_destroy.push(...r):x(r),e.$$.on_mount=[]}),s.forEach(te)}function me(e,t){const n=e.$$;n.fragment!==null&&(Ct(n.after_update),x(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Dt(e,t){e.$$.dirty[0]===-1&&(ie.push(e),Ht(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function ve(e,t,n,l,i,s,r,o=[-1]){const a=_e;de(e);const d=e.$$={fragment:null,ctx:[],props:s,update:F,not_equal:i,bound:je(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(a?a.$$.context:[])),callbacks:je(),dirty:o,skip_bound:!1,root:t.target||a.$$.root};r&&r(d.root);let g=!1;if(d.ctx=n?n(e,t.props||{},(m,w,...u)=>{const h=u.length?u[0]:w;return d.ctx&&i(d.ctx[m],d.ctx[m]=h)&&(!d.skip_bound&&d.bound[m]&&d.bound[m](h),g&&Dt(e,m)),w}):[],d.update(),g=!0,x(d.before_update),d.fragment=l?l(d.ctx):!1,t.target){if(t.hydrate){const m=bt(t.target);d.fragment&&d.fragment.l(m),m.forEach(R)}else d.fragment&&d.fragment.c();t.intro&&X(e.$$.fragment),pe(e,t.target,t.anchor,t.customElement),ut()}de(a)}class we{$destroy(){me(this,1),this.$destroy=F}$on(t,n){if(!Re(n))return F;const l=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return l.push(n),()=>{const i=l.indexOf(n);i!==-1&&l.splice(i,1)}}$set(t){this.$$set&&!_t(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function We(e,{delay:t=0,duration:n=400,easing:l=nt}={}){const i=+getComputedStyle(e).opacity;return{delay:t,duration:n,easing:l,css:s=>`opacity: ${s*i}`}}const Rt="https://MTRData.kennymhhui.repl.co/lr?stnId={stn}",Ot="https://rt.data.gov.hk/v1/transport/mtr/lrt/getSchedule?station_id={stn}";class At{constructor(t,n,l,i,s,r){G(this,"route_no");G(this,"train_length");G(this,"dest_zh");G(this,"dest_en");G(this,"time_num");G(this,"time_text");this.route_no=t,this.train_length=n,this.dest_zh=l,this.dest_en=i,this.time_text=r,this.time_num=s}}class f{constructor(t,n,l){G(this,"name");G(this,"initials");G(this,"platforms");this.name=n,this.initials=t,this.platforms=l}}function $t(e,t=!1){return(t?Ot:Rt).replace("{stn}",e)}const re=new Map([["1",new f("1","屯門碼頭|Tuen Mun Ferry Pier",[2,3,4,5,7])],["10",new f("10","美樂|Melody Garden",[1,2])],["15",new f("15","蝴蝶|Butterfly",[1,2])],["20",new f("20","輕鐵車廠|Light Rail Depot",[1,2])],["30",new f("30","龍門|Lung Mun",[1,2])],["40",new f("40","青山村|Tsing Shan Tsuen",[1,2])],["50",new f("50","青雲|Tsing Wun",[1,2])],["60",new f("60","建安|Kin On",[1,2])],["70",new f("70","河田|Ho Tin",[1,2])],["75",new f("75","蔡意橋|Choy Yee Bridge",[1,2])],["80",new f("80","澤豐|Affluence",[1,2])],["90",new f("90","屯門醫院|Tuen Mun Hospital",[1,2])],["100",new f("100","兆康|Siu Hong",[1,2,5,6])],["110",new f("110","麒麟|Kei Lun",[1,2])],["120",new f("120","青松|Ching Chung",[1,2])],["130",new f("130","建生|Kin Sang",[1,2])],["140",new f("140","田景|Tin King",[1,2,3])],["150",new f("150","良景|Leung King",[1,2])],["160",new f("160","新圍|San Wai",[1,2])],["170",new f("170","石排|Shek Pai",[1,2])],["180",new f("180","山景 (北)|Shan King (North)",[1])],["190",new f("190","山景 (南)|Shan King (South)",[1])],["200",new f("200","鳴琴|Ming Kum",[1,2])],["212",new f("212","大興 (北)|Tai Hing (North)",[1,2])],["220",new f("220","大興 (南)|Tai Hing (South)",[1,2])],["230",new f("230","銀圍|Ngan Wai",[1,2])],["240",new f("240","兆禧|Siu Hei",[1,2])],["250",new f("250","屯門泳池|Tuen Mun Swimming Pool",[1,2])],["260",new f("260","豐景園|Goodview Garden",[1,2])],["265",new f("265","兆麟|Siu Lun",[1,2])],["270",new f("270","安定|On Ting",[1,2])],["275",new f("275","友愛|Yau Oi",[1])],["280",new f("280","市中心|Town Centre",[4])],["295",new f("295","屯門|Tuen Mun",[1,2])],["300",new f("300","杯渡|Pui To",[1,2])],["310",new f("310","何福堂|Hoh Fuk Tong",[1,2])],["320",new f("320","新墟|San Hui",[1,2])],["330",new f("330","景峰|Prime View",[1,2])],["340",new f("340","鳳地|Fung Tei",[1,2])],["350",new f("350","藍地|Lam Tei",[1,2])],["360",new f("360","泥圍|Nai Wai",[1,2])],["370",new f("370","鍾屋村|Chung Uk Tsuen",[1,2])],["380",new f("380","洪水橋|Hung Shui Kiu",[1,2])],["390",new f("390","塘坊村|Tong Fong Tsuen",[1,2])],["400",new f("400","屏山|Ping Shan",[1,2])],["425",new f("425","坑尾村|Hang Mei Tsuen",[1,2])],["430",new f("430","天水圍|Tin Shui Wai",[1,2,3])],["435",new f("435","天慈|Tin Tsz",[1,2])],["445",new f("445","天耀|Tin Yiu",[1,2])],["448",new f("448","樂湖|Locwood",[1,2])],["450",new f("450","天湖|Tin Wu",[1,2])],["455",new f("455","銀座|Ginza",[1,2])],["460",new f("460","天瑞|Tin Shui",[1,2])],["468",new f("468","頌富|Chung Fu",[1,2])],["480",new f("480","天富|Tin Fu",[1,2])],["490",new f("490","翠湖|Chestwood",[1,2])],["500",new f("500","天榮|Tin Wing",[6,7])],["510",new f("510","天悅|Tin Yuet",[1,2])],["520",new f("520","天秀|Tin Sau",[1,2])],["530",new f("530","濕地公園|Wetland Park",[1,2])],["540",new f("540","天恒|Tin Heng",[1,2])],["550",new f("550","天逸|Tin Yat",[1,2,4,5])],["560",new f("560","水邊圍|Shui Pin Wai",[1,2])],["570",new f("570","豐年路|Fung Nin Road",[1,2])],["580",new f("580","康樂路|Hong Lok Road",[1,2])],["590",new f("590","大棠路|Tai Tong Road",[1,2])],["600",new f("600","元朗|Yuen Long",[2,3,4,5])],["920",new f("920","三聖|Sam Shing",[1,3])]]);function qt(e){let t,n,l,i,s,r,o,a,d,g,m,w=(e[3]||"站名")+"",u,h,v,y,I=(e[4]||"Station Name")+"",E,z,L,P,K,U,B,O;return{c(){t=p("div"),n=p("table"),l=p("tr"),i=p("td"),s=p("span"),r=D(e[0]),o=T(),a=p("div"),a.innerHTML="月台<br/>Platform",d=T(),g=p("td"),m=p("span"),u=D(w),h=p("br"),v=T(),y=p("span"),E=D(I),z=T(),L=p("td"),P=D(e[1]),K=D(":"),U=D(e[2]),_(s,"class","platcircle svelte-qg4tih"),_(a,"class","plattext svelte-qg4tih"),_(i,"class","platformCell svelte-qg4tih"),_(m,"class","sizeZH svelte-qg4tih"),_(y,"class","en"),_(g,"class","stnName svelte-qg4tih"),_(g,"role","button"),_(g,"tabindex","0"),_(g,"title","Show Config Menu"),_(L,"class","clock svelte-qg4tih"),_(n,"id","titlebarTB"),_(n,"class","svelte-qg4tih"),_(t,"id","titlebar"),_(t,"class","svelte-qg4tih")},m(M,N){j(M,t,N),c(t,n),c(n,l),c(l,i),c(i,s),c(s,r),c(i,o),c(i,a),c(l,d),c(l,g),c(g,m),c(m,u),c(g,h),c(g,v),c(g,y),c(y,E),c(l,z),c(l,L),c(L,P),c(L,K),c(L,U),B||(O=[ee(g,"click",e[5]),ee(g,"keypress",e[5])],B=!0)},p(M,[N]){N&1&&W(r,M[0]),N&8&&w!==(w=(M[3]||"站名")+"")&&W(u,w),N&16&&I!==(I=(M[4]||"Station Name")+"")&&W(E,I),N&2&&W(P,M[1]),N&4&&W(U,M[2])},i:F,o:F,d(M){M&&R(t),B=!1,x(O)}}}function jt(e,t,n){let{stnId:l}=t,{platform:i}=t;const s=It();let r=new Date,o,a,d,g;function m(){s("showConfig")}function w(){n(8,r=new Date)}return Ae(()=>{const u=setInterval(w,2e3);return w(),()=>clearInterval(u)}),e.$$set=u=>{"stnId"in u&&n(6,l=u.stnId),"platform"in u&&n(0,i=u.platform)},e.$$.update=()=>{var u,h;e.$$.dirty&256&&n(1,o=r.getHours().toString().padStart(2,"0")),e.$$.dirty&256&&n(2,a=r.getMinutes().toString().padStart(2,"0")),e.$$.dirty&64&&n(3,d=((u=re.get(l))==null?void 0:u.name.split("|")[0])||""),e.$$.dirty&64&&n(4,g=((h=re.get(l))==null?void 0:h.name.split("|")[1])||"")},[i,o,a,d,g,m,l,w,r]}class Ft extends we{constructor(t){super(),ve(this,t,jt,qt,ge,{stnId:6,platform:0,updateDate:7})}get updateDate(){return this.$$.ctx[7]}}function Be(e,t,n){const l=e.slice();return l[4]=t[n],l[6]=n,l}function Ye(e,t,n){const l=e.slice();return l[4]=t[n],l[6]=n,l}function Kt(e){let t;return{c(){t=p("div"),t.innerHTML=`<div class="sizeDouble svelte-pxmlct"> </div> 
            <div class="svelte-pxmlct"></div> 
            <div class="svelte-pxmlct"></div> 
            <div class="svelte-pxmlct"></div> 
          `,_(t,"class","arrRow svelte-pxmlct")},m(n,l){j(n,t,l)},p:F,d(n){n&&R(t)}}}function Zt(e){let t,n,l=e[0][e[6]].route_no+"",i,s,r,o,a=e[0][e[6]].dest_zh+"",d,g,m=e[0][e[6]].dest_en+"",w,u,h,v,y,I,E=e[0][e[6]].time_num+"",z,L,P,K=e[0][e[6]].time_text.split("|")[0]+"",U,B,O=e[0][e[6]].time_text.split("|")[1]+"",M,N,V={length:e[0][e[6]].train_length},C=[];for(let S=0;S<V.length;S+=1)C[S]=Ue(Ye(e,V,S));return{c(){t=p("div"),n=p("div"),i=D(l),s=T(),r=p("div"),o=p("span"),d=D(a),g=p("br"),w=D(m),u=T(),h=p("div");for(let S=0;S<C.length;S+=1)C[S].c();v=T(),y=p("div"),I=p("span"),z=D(E),L=T(),P=p("div"),U=D(K),B=p("br"),M=D(O),N=T(),_(n,"class","sizeDouble svelte-pxmlct"),_(o,"class","sizeZH svelte-pxmlct"),_(r,"class","svelte-pxmlct"),_(h,"class","cars svelte-pxmlct"),_(I,"class","sizeDouble multiLine svelte-pxmlct"),_(P,"class","eta"),_(y,"class","svelte-pxmlct"),_(t,"class","row arrRow svelte-pxmlct")},m(S,q){j(S,t,q),c(t,n),c(n,i),c(t,s),c(t,r),c(r,o),c(o,d),c(r,g),c(r,w),c(t,u),c(t,h);for(let H=0;H<C.length;H+=1)C[H]&&C[H].m(h,null);c(t,v),c(t,y),c(y,I),c(I,z),c(y,L),c(y,P),c(P,U),c(P,B),c(P,M),c(t,N)},p(S,q){if(q&1&&l!==(l=S[0][S[6]].route_no+"")&&W(i,l),q&1&&a!==(a=S[0][S[6]].dest_zh+"")&&W(d,a),q&1&&m!==(m=S[0][S[6]].dest_en+"")&&W(w,m),q&1){V={length:S[0][S[6]].train_length};let H;for(H=0;H<V.length;H+=1){const J=Ye(S,V,H);C[H]?C[H].p(J,q):(C[H]=Ue(J),C[H].c(),C[H].m(h,null))}for(;H<C.length;H+=1)C[H].d(1);C.length=V.length}q&1&&E!==(E=S[0][S[6]].time_num+"")&&W(z,E),q&1&&K!==(K=S[0][S[6]].time_text.split("|")[0]+"")&&W(U,K),q&1&&O!==(O=S[0][S[6]].time_text.split("|")[1]+"")&&W(M,O)},d(S){S&&R(t),Te(C,S)}}}function Ue(e){let t,n;return{c(){t=p("img"),_(t,"class","car svelte-pxmlct"),ht(t.src,n="img/lrv.png")||_(t,"src",n),_(t,"alt","LRV Car "+e[6])},m(l,i){j(l,t,i)},p:F,d(l){l&&R(t)}}}function Ge(e){let t;function n(s,r){return s[6]<s[0].length?Zt:Kt}let l=n(e),i=l(e);return{c(){i.c(),t=wt()},m(s,r){i.m(s,r),j(s,t,r)},p(s,r){l===(l=n(s))&&i?i.p(s,r):(i.d(1),i=l(s),i&&(i.c(),i.m(t.parentNode,t)))},d(s){i.d(s),s&&R(t)}}}function Wt(e){let t,n,l,i={length:Ve},s=[];for(let r=0;r<i.length;r+=1)s[r]=Ge(Be(e,i,r));return{c(){t=p("main"),n=p("div"),n.innerHTML=`<div class="svelte-pxmlct"><span class="sizeZH svelte-pxmlct">路線</span><br/>Route</div> 
        <div class="svelte-pxmlct"><span class="sizeZH svelte-pxmlct">目的地</span><br/>Destination</div> 
        <div class="svelte-pxmlct"></div> 
        <div class="svelte-pxmlct"><span class="sizeZH svelte-pxmlct">下班車</span><br/>Next Train</div>`,l=T();for(let r=0;r<s.length;r+=1)s[r].c();_(n,"class","row header svelte-pxmlct"),_(t,"class","svelte-pxmlct")},m(r,o){j(r,t,o),c(t,n),c(t,l);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(t,null)},p(r,[o]){if(o&1){i={length:Ve};let a;for(a=0;a<i.length;a+=1){const d=Be(r,i,a);s[a]?s[a].p(d,o):(s[a]=Ge(d),s[a].c(),s[a].m(t,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=i.length}},i:F,o:F,d(r){r&&R(t),Te(s,r)}}}const Ve=10;function Bt(e,t,n){let{stnId:l}=t,{targetPlatform:i}=t,s=[];async function r(o,a,d=!1){if(o==null||a==null)return;let g;try{g=await fetch($t(o,d))}catch{if(!d)return console.warn("Cannot fetch data from proxy server, falling back to MTR"),r(o,a,!0)}let m=await g.json();if(m.status!=1)return;let w=[];for(let u of m.platform_list)if(u.platform_id===a)for(let h of u.route_list){if(h.stop===1)continue;let v,y;h.time_en.includes("min")?(v="分鐘|min",y=h.time_en.split(" min")[0]):h.time_en==="-"?(v=" | ",y="-"):(y="",v=`${h.time_ch}|${h.time_en}`);let I=new At(h.route_no,h.train_length,h.dest_ch,h.dest_en,y,v);w.push(I)}n(0,s=w)}return Ae(async()=>{const o=setInterval(async()=>await r(l,i),1e4);return()=>clearInterval(o)}),e.$$set=o=>{"stnId"in o&&n(1,l=o.stnId),"targetPlatform"in o&&n(2,i=o.targetPlatform)},e.$$.update=()=>{e.$$.dirty&6&&r(l,i)},[s,l,i]}class Yt extends we{constructor(t){super(),ve(this,t,Bt,Wt,ge,{stnId:1,targetPlatform:2})}}function Ut(e){let t,n,l,i;return t=new Ft({props:{stnId:e[0],platform:e[1]}}),t.$on("showConfig",e[2]),l=new Yt({props:{stnId:e[0],targetPlatform:e[1]}}),{c(){He(t.$$.fragment),n=T(),He(l.$$.fragment)},m(s,r){pe(t,s,r),j(s,n,r),pe(l,s,r),i=!0},p(s,[r]){const o={};r&1&&(o.stnId=s[0]),r&2&&(o.platform=s[1]),t.$set(o);const a={};r&1&&(a.stnId=s[0]),r&2&&(a.targetPlatform=s[1]),l.$set(a)},i(s){i||(X(t.$$.fragment,s),X(l.$$.fragment,s),i=!0)},o(s){ce(t.$$.fragment,s),ce(l.$$.fragment,s),i=!1},d(s){me(t,s),s&&R(n),me(l,s)}}}function Gt(e,t,n){let{stnId:l}=t,{platform:i}=t;function s(r){ct.call(this,e,r)}return e.$$set=r=>{"stnId"in r&&n(0,l=r.stnId),"platform"in r&&n(1,i=r.platform)},[l,i,s]}class Vt extends we{constructor(t){super(),ve(this,t,Gt,Ut,ge,{stnId:0,platform:1})}}function Qe(e,t,n){const l=e.slice();return l[8]=t[n],l}function Je(e,t,n){const l=e.slice();return l[11]=t[n][0],l[12]=t[n][1],l}function Xe(e){let t,n=e[12].name.replace("|"," ")+"",l;return{c(){t=p("option"),l=D(n),t.__value=e[11],t.value=t.__value},m(i,s){j(i,t,s),c(t,l)},p:F,d(i){i&&R(t)}}}function xe(e){let t,n=e[8]+"",l,i;return{c(){t=p("option"),l=D(n),t.__value=i=e[8],t.value=t.__value},m(s,r){j(s,t,r),c(t,l)},p(s,r){r&1&&n!==(n=s[8]+"")&&W(l,n),r&1&&i!==(i=s[8])&&(t.__value=i,t.value=t.__value)},d(s){s&&R(t)}}}function Qt(e){var qe;let t,n,l,i,s,r,o,a,d,g,m,w,u,h,v,y,I,E,z,L,P,K,U,B,O,M,N,V,C,S,q,H,J,Pe,$e,ne=[...re],A=[];for(let b=0;b<ne.length;b+=1)A[b]=Xe(Je(e,ne,b));let le=((qe=re.get(e[0]))==null?void 0:qe.platforms)??[],$=[];for(let b=0;b<le.length;b+=1)$[b]=xe(Qe(e,le,b));return{c(){t=p("main"),n=p("h1"),n.textContent="輕鐵資訊顯示屏模擬器",l=T(),i=p("h3"),i.textContent="Light Rail PIDS Simulator",s=T(),r=p("hr"),o=T(),a=p("table"),d=p("tr"),g=p("td"),g.innerHTML='<span class="sizeZH svelte-3fs0rb">車站</span><br/><span class="sizeEN svelte-3fs0rb">Station</span>',m=T(),w=p("td"),u=p("select");for(let b=0;b<A.length;b+=1)A[b].c();h=T(),v=p("tr"),y=p("td"),y.innerHTML='<span class="sizeZH svelte-3fs0rb">月台</span><br/><span class="sizeEN svelte-3fs0rb">Platform</span>',I=T(),E=p("td"),z=p("select");for(let b=0;b<$.length;b+=1)$[b].c();L=T(),P=p("tr"),K=p("td"),K.innerHTML='<span class="sizeZH svelte-3fs0rb">全螢幕</span><br/><span class="sizeEN svelte-3fs0rb">Full Screen</span>',U=T(),B=p("td"),O=p("input"),M=T(),N=p("button"),N.textContent="開始 Start",V=T(),C=p("p"),C.textContent="如需要再顯示此菜單，請按頂部的車站名",S=T(),q=p("p"),q.textContent="Click the station name at the top to return to this menu.",H=T(),J=p("footer"),J.innerHTML=`<p class="svelte-3fs0rb"><a href="https://hktss.github.io/mtr-pids/" target="_blank" rel="noopener noreferrer">願景資訊顯示屏模擬器<br/>Railway Vision PIDS Simulator</a></p> 
    <a href="https://hktss.github.io/" target="_blank" rel="noopener noreferrer" class="svelte-3fs0rb"><img class="logo" src="img/tss_logo.png" alt="HKTSS Logo" height="40"/></a>`,_(n,"class","sizeZH svelte-3fs0rb"),_(i,"class","sizeEN svelte-3fs0rb"),_(g,"class","svelte-3fs0rb"),_(u,"id","stnOpt"),_(u,"class","svelte-3fs0rb"),e[0]===void 0&&te(()=>e[4].call(u)),_(w,"class","svelte-3fs0rb"),_(d,"class","svelte-3fs0rb"),_(y,"class","svelte-3fs0rb"),_(z,"id","platOpt"),_(z,"class","svelte-3fs0rb"),e[1]===void 0&&te(()=>e[5].call(z)),_(E,"class","svelte-3fs0rb"),_(v,"class","svelte-3fs0rb"),_(K,"class","svelte-3fs0rb"),_(O,"type","checkbox"),_(B,"class","svelte-3fs0rb"),_(P,"class","svelte-3fs0rb"),_(a,"id","cfgTable"),_(a,"class","svelte-3fs0rb"),_(N,"class","closeBtn svelte-3fs0rb"),_(t,"class","svelte-3fs0rb"),_(J,"class","svelte-3fs0rb")},m(b,Y){j(b,t,Y),c(t,n),c(t,l),c(t,i),c(t,s),c(t,r),c(t,o),c(t,a),c(a,d),c(d,g),c(d,m),c(d,w),c(w,u);for(let Z=0;Z<A.length;Z+=1)A[Z]&&A[Z].m(u,null);ye(u,e[0],!0),c(a,h),c(a,v),c(v,y),c(v,I),c(v,E),c(E,z);for(let Z=0;Z<$.length;Z+=1)$[Z]&&$[Z].m(z,null);ye(z,e[1],!0),c(a,L),c(a,P),c(P,K),c(P,U),c(P,B),c(B,O),O.checked=e[2],c(t,M),c(t,N),c(t,V),c(t,C),c(t,S),c(t,q),j(b,H,Y),j(b,J,Y),Pe||($e=[ee(u,"change",e[4]),ee(z,"change",e[5]),ee(O,"change",e[6]),ee(O,"click",e[7]),ee(N,"click",e[3])],Pe=!0)},p(b,[Y]){var Z;if(Y&0){ne=[...re];let k;for(k=0;k<ne.length;k+=1){const ue=Je(b,ne,k);A[k]?A[k].p(ue,Y):(A[k]=Xe(ue),A[k].c(),A[k].m(u,null))}for(;k<A.length;k+=1)A[k].d(1);A.length=ne.length}if(Y&1&&ye(u,b[0]),Y&1){le=((Z=re.get(b[0]))==null?void 0:Z.platforms)??[];let k;for(k=0;k<le.length;k+=1){const ue=Qe(b,le,k);$[k]?$[k].p(ue,Y):($[k]=xe(ue),$[k].c(),$[k].m(z,null))}for(;k<$.length;k+=1)$[k].d(1);$.length=le.length}Y&3&&ye(z,b[1]),Y&4&&(O.checked=b[2])},i:F,o:F,d(b){b&&R(t),Te(A,b),Te($,b),b&&R(H),b&&R(J),Pe=!1,x($e)}}}function Jt(e,t,n){let{stationId:l}=t,{selectedPlatform:i}=t,{useHorizontal:s}=t;function r(m){ct.call(this,e,m)}function o(){l=Fe(this),n(0,l)}function a(){i=Fe(this),n(1,i),n(0,l)}function d(){s=this.checked,n(2,s)}const g=()=>n(2,s=!s);return e.$$set=m=>{"stationId"in m&&n(0,l=m.stationId),"selectedPlatform"in m&&n(1,i=m.selectedPlatform),"useHorizontal"in m&&n(2,s=m.useHorizontal)},[l,i,s,r,o,a,d,g]}class Xt extends we{constructor(t){super(),ve(this,t,Jt,Qt,ge,{stationId:0,selectedPlatform:1,useHorizontal:2})}}function et(e){let t,n,l,i,s,r,o,a;function d(u){e[5](u)}function g(u){e[6](u)}function m(u){e[7](u)}let w={};return e[0]!==void 0&&(w.stationId=e[0]),e[1]!==void 0&&(w.selectedPlatform=e[1]),e[2]!==void 0&&(w.useHorizontal=e[2]),n=new Xt({props:w}),he.push(()=>Me(n,"stationId",d)),he.push(()=>Me(n,"selectedPlatform",g)),he.push(()=>Me(n,"useHorizontal",m)),n.$on("click",e[8]),{c(){t=p("div"),He(n.$$.fragment),_(t,"class",r=ke(e[2]?"horizontal":"portrait")+" svelte-1pj8315")},m(u,h){j(u,t,h),pe(n,t,null),a=!0},p(u,h){const v={};!l&&h&1&&(l=!0,v.stationId=u[0],Ce(()=>l=!1)),!i&&h&2&&(i=!0,v.selectedPlatform=u[1],Ce(()=>i=!1)),!s&&h&4&&(s=!0,v.useHorizontal=u[2],Ce(()=>s=!1)),n.$set(v),(!a||h&4&&r!==(r=ke(u[2]?"horizontal":"portrait")+" svelte-1pj8315"))&&_(t,"class",r)},i(u){a||(X(n.$$.fragment,u),te(()=>{a&&(o||(o=Ze(t,We,{duration:100},!0)),o.run(1))}),a=!0)},o(u){ce(n.$$.fragment,u),o||(o=Ze(t,We,{duration:100},!1)),o.run(0),a=!1},d(u){u&&R(t),me(n),u&&o&&o.end()}}}function xt(e){let t,n,l,i,s,r;l=new Vt({props:{stnId:e[0],platform:e[1]}}),l.$on("showConfig",e[4]);let o=e[3]&&et(e);return{c(){t=p("main"),n=p("div"),He(l.$$.fragment),s=T(),o&&o.c(),_(n,"class",i=ke(e[2]?"horizontal":"portrait")+" svelte-1pj8315"),_(t,"class","svelte-1pj8315")},m(a,d){j(a,t,d),c(t,n),pe(l,n,null),c(t,s),o&&o.m(t,null),r=!0},p(a,[d]){const g={};d&1&&(g.stnId=a[0]),d&2&&(g.platform=a[1]),l.$set(g),(!r||d&4&&i!==(i=ke(a[2]?"horizontal":"portrait")+" svelte-1pj8315"))&&_(n,"class",i),a[3]?o?(o.p(a,d),d&8&&X(o,1)):(o=et(a),o.c(),X(o,1),o.m(t,null)):o&&(Lt(),ce(o,1,1,()=>{o=null}),Mt())},i(a){r||(X(l.$$.fragment,a),X(o),r=!0)},o(a){ce(l.$$.fragment,a),ce(o),r=!1},d(a){a&&R(t),me(l),o&&o.d()}}}function tt(e,t,n){e!==void 0&&localStorage.setItem("stnId",e),t!==void 0&&localStorage.setItem("platform",t.toString()),localStorage.setItem("horizontal",String(n))}function en(e,t,n){let l,i,s=!1,r=!1;function o(){let h=localStorage.getItem("platform"),v=localStorage.getItem("stnId"),y=localStorage.getItem("horizontal");h==null||v==null?(n(0,l="1"),n(1,i=2),n(3,r=!0)):(n(0,l=v),n(1,i=parseInt(h))),y=="true"&&n(2,s=!0)}function a(){const h=new URLSearchParams(window.location.search),v=Object.fromEntries(h.entries());v.stnId!=null&&v.plat!=null&&(n(3,r=!1),n(0,l=v.stnId),n(1,i=parseInt(v.plat))),v.horz!=null&&n(2,s=v.horz=="true")}Ae(()=>{o(),a(),tt(l,i,s)});const d=()=>n(3,r=!0);function g(h){l=h,n(0,l)}function m(h){i=h,n(1,i)}function w(h){s=h,n(2,s)}return[l,i,s,r,d,g,m,w,()=>{n(3,r=!1),tt(l,i,s)}]}class tn extends we{constructor(t){super(),ve(this,t,en,xt,ge,{})}}new tn({target:document.getElementById("app")});
